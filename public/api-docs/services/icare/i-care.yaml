openapi: 3.0.0
info:
  title: Katalog iCare JKN
  version: 1.0.0
  description: |
    Katalog layanan API Data Riwayat Pelayanan iCare JKN untuk FKRTL dan FKTP.

servers:
  - url: http://localhost:3001/api/bpjs/ihs_dev
    description: Proxy Backend Local

tags:
  - name: FKRTL
    description: Endpoint validasi dan data riwayat pelayanan FKRTL
  - name: FKTP
    description: Endpoint validasi dan data riwayat pelayanan FKTP

paths:
  /{serviceName}/api/rs/validate:
    post:
      tags:
        - FKRTL
      summary: Validasi Data Riwayat Pelayanan FKRTL
      description: Endpoint untuk validasi dan mendapatkan data riwayat pelayanan FKRTL.
      operationId: validateFKRTL
      parameters:
        - name: x-cons-id
          in: header
          required: true
          schema:
            type: string
        - name: x-timestamp
          in: header
          required: true
          schema:
            type: string
        - name: x-signature
          in: header
          required: true
          schema:
            type: string
        - name: user_key
          in: header
          required: true
          schema:
            type: string
        - name: serviceName
          in: path
          required: true
          schema:
            type: string
          description: Nama service
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FKRTLRequest'
            example:
              param: "2200009338321"
              kodedokter: 11111
      responses:
        '200':
          description: Berhasil mendapatkan data riwayat pelayanan FKRTL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidateResponse'
              example:
                response:
                  url: "https://dvlp.bpjs-kesehatan.go.id/ihs/history?token=e6b610b4-2960-46a3-8420-de879756dce3"
                metaData:
                  code: 200
                  message: "Sukses"
        '400':
          description: Bad Request
        '500':
          description: Internal Server Error

  /{serviceName}/api/pcare/validate:
    post:
      tags:
        - FKTP
      summary: Validasi Data Riwayat Pelayanan FKTP
      description: Endpoint untuk validasi dan mendapatkan data riwayat pelayanan FKTP.
      operationId: validateFKTP
      parameters:
        - name: x-cons-id
          in: header
          required: true
          schema:
            type: string
        - name: x-timestamp
          in: header
          required: true
          schema:
            type: string
        - name: x-signature
          in: header
          required: true
          schema:
            type: string
        - name: x-authorization
          in: header
          required: true
          schema:
            type: string
        - name: user_key
          in: header
          required: true
          schema:
            type: string
        - name: serviceName
          in: path
          required: true
          schema:
            type: string
          description: Nama service
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FKTPRequest'
            example:
              param: "2200009338321"
      responses:
        '200':
          description: Berhasil mendapatkan data riwayat pelayanan FKTP
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidateResponse'
              example:
                response:
                  url: "https://dvlp.bpjs-kesehatan.go.id/ihs/history?token=e6b610b4-2960-46a3-8420-de879756dce3"
                metaData:
                  code: 200
                  message: "Sukses"
        '400':
          description: Bad Request
        '500':
          description: Internal Server Error

components:
  schemas:
    FKRTLRequest:
      type: object
      required:
        - param
        - kodedokter
      properties:
        param:
          type: string
          description: Nomor kartu peserta
          example: "2200009338321"
        kodedokter:
          type: integer
          description: Kode dokter
          example: 11111
    FKTPRequest:
      type: object
      required:
        - param
      properties:
        param:
          type: string
          description: Nomor kartu peserta
          example: "2200009338321"
    ValidateResponse:
      type: object
      properties:
        response:
          type: object
          properties:
            url:
              type: string
              description: URL hasil validasi
              example: "https://dvlp.bpjs-kesehatan.go.id/ihs/history?token=e6b610b4-2960-46a3-8420-de879756dce3"
        metaData:
          $ref: '#/components/schemas/MetaData'
    MetaData:
      type: object
      properties:
        code:
          type: integer
          description: Kode response
          example: 200
        message:
          type: string
          description: Pesan response
          example: "Sukses"
